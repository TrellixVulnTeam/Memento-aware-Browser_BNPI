(function(){'use strict';function k(a,b){a=a.split(".");let c=aa;for(let d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!=Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b};var aa=self;k("mojo.internal.exportModule",function(a){let b=aa;a=a.split(".");for(let c;a.length&&(c=a.shift());)b[c]||(b[c]={}),b=b[c]});var l=!!(new Uint8Array((new Uint16Array([1])).buffer))[0];function m(a){return null===a||void 0===a}function n(a){return a+(8-a%8)%8}
function q(a,b,c){l?(a.setUint32(b,Number(BigInt(c)&BigInt(4294967295)),l),a.setUint32(b+4,Number(BigInt(c)>>BigInt(32)),l)):(a.setUint32(b,Number(BigInt(c)>>BigInt(32)),l),a.setUint32(b+4,Number(BigInt(c)&BigInt(4294967295)),l))}function ba(a,b){let c=8+a.K;for(const d of a.m)a=b[d.name],d.type.$.o&&!m(a)&&(c+=n(d.type.$.o(a,d.D)));return c}function ca(a,b){return a.g===r?8+(b.length+7)>>3:8+b.length*a.g.$.f(!!a.s)}
function t(a,b){var c=ca(a,b);if(!a.g.$.o)return c;for(let d of b)m(d)||(c+=n(a.g.$.o(d,!!a.s)));return c}function da(a,b){if(l){var c=a.getUint32(b,l);a=a.getUint32(b+4,l)}else c=a.getUint32(b+4,l),a=a.getUint32(b,l);c=BigInt(a)<<BigInt(32)|BigInt(c);return c<=BigInt(Number.MAX_SAFE_INTEGER)?Number(c):c}function u(a,b){b=n(b);const c=new DataView(a.buffer,a.a,b);a.a+=b;return c}
var fa=class{constructor(a,b,c,d,e){let f,g;0==(a&3)?(f=24,g=0):(f=32,g=1);var h=f+ba(d,e);this.buffer=new ArrayBuffer(h);this.handles=[];h=new DataView(this.buffer);h.setUint32(0,f,l);h.setUint32(4,g,l);h.setUint32(8,0);h.setUint32(12,b,l);h.setUint32(16,a,l);h.setUint32(20,0);0<g&&q(h,24,c);this.a=f;a=u(this,8+d.K);ea(new v(this,a),d,e)}};function ha(a){w||(w=new TextEncoder("utf-8"));return w.encode(a)}
function ea(a,b,c){x(a,0,8+b.K);x(a,4,0);for(const d of b.m){const e=8+d.S;if(c&&c instanceof Object&&!m(c[d.name]))d.type.$.encode(c[d.name],a,e,d.P,d.D);else if(null!==d.defaultValue)d.type.$.encode(d.defaultValue,a,e,d.P,d.D);else if(d.D)d.type.$.w(a,e);else throw Error(b.name+' missing value for non-nullable field "'+d.name+'"');}}function ia(a,b,c,d){const e=a.j.getUint8(b);d?a.j.setUint8(b,e|1<<c):a.j.setUint8(b,e&~(1<<c))}function x(a,b,c){a.j.setUint32(b,c,l)}
function y(a,b,c){x(a,b,a.u.handles.length);a.u.handles.push(c)}function z(a,b,c,d){const e=ca(b,d),f=u(a.u,e),g=new v(a.u,f);A(a,c,f.byteOffset);x(g,0,e);x(g,4,d.length);a=8;if(b.g===r){b=0;for(const h of d)ia(g,a,b,h),b++,8==b&&(b=0,a++)}else for(const h of d){if(null===h){if(!b.s)throw Error("Trying to send a null element in an array of non-nullable elements");b.g.$.w(g,a)}b.g.$.encode(h,g,a,0,!!b.s);a+=b.g.$.f(!!b.s)}}function A(a,b,c){q(a.j,b,c-a.j.byteOffset-b)}
function ja(a,b,c,d){let e,f;d instanceof Map?(e=Array.from(d.keys()),f=Array.from(d.values())):(e=Object.keys(d),f=e.map(p=>d[p]));const g=u(a.u,24),h=new v(a.u,g);A(a,c,g.byteOffset);x(h,0,24);x(h,4,0);z(h,{g:b.O},8,e);z(h,{g:b.valueType,s:b.U},16,f)}var v=class{constructor(a,b){this.u=a;this.j=b}},w=null;function ka(a,b,c){return!!(a.h.getUint8(b)&1<<c)}function B(a,b){return a.h.getUint32(b,l)}
function C(a,b){b=a.h.getUint32(b,l);if(4294967295==b)return null;if(b>=a.C.length)throw Error("Decoded invalid handle index");return a.C[b]}function D(a,b,c){c=E(a,c);if(!c)return null;a=new F(new DataView(a.h.buffer,c),a.C);B(a,0);c=B(a,4);if(!c)return[];const d=[];if(b.g===r)for(b=0;b<c;++b)d.push(ka(a,8+(b>>3),b%8));else{let e=8;for(let f=0;f<c;++f){const g=b.g.$.decode(a,e,0,!!b.s);if(null===g&&!b.s)throw Error("Received unexpected array element");d.push(g);e+=b.g.$.f(!!b.s)}}return d}
function E(a,b){const c=da(a.h,b);return 0==c?0:a.h.byteOffset+b+c}function G(a,b){B(a,0);B(a,4);const c={};for(const d of b.m){const e=d.type.$.decode(a,8+d.S,d.P,!!d.D);if(null===e&&!d.D)throw Error("Received "+b.name+' with invalid null field "'+d.name+'"');c[d.name]=e}return c}var F=class{constructor(a,b){this.h=a;this.C=b}},H=null;function I(a,b,c,d,e,f){b=new fa(d,b,c,e.$.B,f);a.writeMessage(b.buffer,b.handles)}
function la(a){var b=a.getUint32(0,l);const c=a.getUint32(4,l);if(0==c&&24!=b||1==c&&32!=b||2<c)throw Error("Received invalid message header");if(2==c)throw Error("v2 messages not yet supported");b={M:b,F:a.getUint32(12,l),flags:a.getUint32(16,l)};b.requestId=0<c?a.getUint32(24,l):0;return b}var r={$:{encode:function(a,b,c,d){ia(b,c,d,a)},decode:function(a,b,c){return ka(a,b,c)},c:!0}};k("mojo.internal.Bool",r);
k("mojo.internal.Int8",{$:{encode:function(a,b,c){b.j.setInt8(c,a)},decode:function(a,b){return a.h.getInt8(b)},f:()=>1,c:!0}});var J={$:{encode:function(a,b,c){b.j.setUint8(c,a)},decode:function(a,b){return a.h.getUint8(b)},f:()=>1,c:!0}};k("mojo.internal.Uint8",J);k("mojo.internal.Int16",{$:{encode:function(a,b,c){b.j.setInt16(c,a,l)},decode:function(a,b){return a.h.getInt16(b,l)},f:()=>2,c:!0}});
k("mojo.internal.Uint16",{$:{encode:function(a,b,c){b.j.setUint16(c,a,l)},decode:function(a,b){return a.h.getUint16(b,l)},f:()=>2,c:!0}});k("mojo.internal.Int32",{$:{encode:function(a,b,c){b.j.setInt32(c,a,l)},decode:function(a,b){return a.h.getInt32(b,l)},f:()=>4,c:!0}});var K={$:{encode:function(a,b,c){x(b,c,a)},decode:function(a,b){return B(a,b)},f:()=>4,c:!0}};k("mojo.internal.Uint32",K);
var ma={$:{encode:function(a,b,c){b=b.j;l?(b.setUint32(c,Number(BigInt(a)&BigInt(4294967295)),l),b.setInt32(c+4,Number(BigInt(a)>>BigInt(32)),l)):(b.setInt32(c,Number(BigInt(a)>>BigInt(32)),l),b.setUint32(c+4,Number(BigInt(a)&BigInt(4294967295)),l))},decode:function(a,b){var c=a.h;l?(a=c.getUint32(b,l),b=c.getInt32(b+4,l)):(a=c.getUint32(b+4,l),b=c.getInt32(b,l));b=BigInt(b)<<BigInt(32)|BigInt(a);return b=b<=BigInt(Number.MAX_SAFE_INTEGER)&&b>=BigInt(Number.MIN_SAFE_INTEGER)?Number(b):b},f:()=>8,
c:!0}};k("mojo.internal.Int64",ma);k("mojo.internal.Uint64",{$:{encode:function(a,b,c){q(b.j,c,a)},decode:function(a,b){return da(a.h,b)},f:()=>8,c:!0}});k("mojo.internal.Float",{$:{encode:function(a,b,c){b.j.setFloat32(c,a,l)},decode:function(a,b){return a.h.getFloat32(b,l)},f:()=>4,c:!0}});k("mojo.internal.Double",{$:{encode:function(a,b,c){b.j.setFloat64(c,a,l)},decode:function(a,b){return a.h.getFloat64(b,l)},f:()=>8,c:!0}});
var L={$:{encode:function(a,b,c){y(b,c,a)},w:function(){},decode:function(a,b){return C(a,b)},f:()=>4,c:!1}};k("mojo.internal.Handle",L);var na={$:{encode:function(a,b,c){if("string"!==typeof a)throw Error("Unxpected non-string value for string field.");z(b,{g:J},c,ha(a))},w:function(){},decode:function(a,b){H||(H=new TextDecoder("utf-8"));return H.decode((new Uint8Array(D(a,{g:J},b))).buffer)},o:function(a){return t({g:J},ha(a))},f:()=>8,c:!0}};k("mojo.internal.String",na);
function M(a,b){const c={g:a,s:b};return{$:{fa:c,encode:function(d,e,f){z(e,c,f,d)},w:function(){},decode:function(d,e){return D(d,c,e)},o:function(d){return t(c,d)},f:()=>8,c:!1}}}k("mojo.internal.Array",M);
k("mojo.internal.Map",function(a,b,c){const d={O:a,valueType:b,U:c};return{$:{ga:d,encode:function(e,f,g){ja(f,d,g,e)},w:function(){},decode:function(e,f){if(f=E(e,f)){f=new F(new DataView(e.h.buffer,f),e.C);e=B(f,0);var g=B(f,4);if(24!=e||0!=g)throw Error("Received invalid map data");e=D(f,{g:d.O},8);f=D(f,{g:d.valueType,s:d.U},16);if(e.length!=f.length)throw Error("Received invalid map data");if(d.O.$.c){g={};for(var h=0;h<e.length;++h)g[e[h]]=f[h];e=g}else{g=new Map;for(h=0;h<e.length;++h)g.set(e[h],
f[h]);e=g}}else e=null;return e},o:function(e){const f=e instanceof Map?Array.from(e.keys()):Object.keys(e),g=e instanceof Map?Array.from(e.values()):f.map(h=>e[h]);return 24+t({g:a},f)+t({g:b,s:c},g)},f:()=>8,c:!1}}});function oa(){return{$:{encode:function(a,b,c){x(b,c,a)},decode:function(a,b){return a.h.getInt32(b,l)},f:()=>4,c:!0}}}k("mojo.internal.Enum",oa);function N(a,b,c,d,e,f){return{name:a,S:b,P:c,type:d,defaultValue:e,D:f}}k("mojo.internal.StructField",N);
function O(a,b,c,d){const e={name:b,K:c,m:d};a.$={B:e,encode:function(f,g,h){{const p=u(g.u,8+e.K),Oa=new v(g.u,p);A(g,h,p.byteOffset);ea(Oa,e,f)}},w:function(){},decode:function(f,g){return f=(g=E(f,g))?G(new F(new DataView(f.h.buffer,g),f.C),e):null},o:function(f){return ba(e,f)},f:()=>8,c:!1}}k("mojo.internal.Struct",O);k("mojo.internal.createStructDeserializer",function(a){return function(b){if(void 0==a.$||void 0==a.$.B)throw Error("Invalid struct mojom type!");return G(new F(b,[]),a.$.B)}});
function P(a,b,c){const d={name:b,m:c};a.$={Z:d,encode:function(e,f,g,h,p){h=f;p&&(h=u(f.u,16),A(f,g,h.byteOffset),g=0,h=new v(f.u,h));f=Object.keys(e);if(1!==f.length)throw Error(`Value for ${d.name} must be an Object with a `+"single property named one of: "+Object.keys(d.m).join(","));f=f[0];p=d.m[f];x(h,g,16);x(h,g+4,p.ordinal);p.type.$.encode(e[f],h,g+8,0,p.nullable)},w:function(){},decode:function(e,f,g,h){a:{g=e;if(h){h=E(e,f);if(!h){var p=null;break a}g=new F(new DataView(e.h.buffer,h),e.C);
f=0}h=B(g,f+4);for(p in d.m)if(e=d.m[p],e.ordinal===h){h=e.type.$.decode(g,f+8,0,e.nullable);if(null===h&&!e.nullable)throw Error(`Received ${d.name} with invalid null `+`field: ${e.name}`);e={};e[p]=h;p=e;break a}p=void 0}return p},o:function(e,f){{f=f?16:0;var g=Object.keys(e);if(1!==g.length)throw Error(`Value for ${d.name} must be an Object with a `+"single property named one of: "+Object.keys(d.m).join(","));const h=g[0];g=d.m[h];e=e[h];m(e)||(g.type.$.Z?f+=n(g.type.$.o(e,!0)):g.type.$.o&&(f+=
n(g.type.$.o(e,g.nullable))));e=f}return e},f:e=>e?8:16,c:!1}}k("mojo.internal.Union",P);k("mojo.internal.InterfaceProxy",function(a){return{$:{encode:function(b,c,d){if(!(b instanceof a))throw Error("Invalid proxy type. Expected "+a.name);if(!b.proxy.handle)throw Error("Unexpected null "+a.name);y(c,d,b.proxy.handle);x(c,d+4,0);b.proxy.T()},w:function(b,c){x(b,c,4294967295)},decode:function(b,c){{const d=C(b,c);B(b,c+4);b=d?new a(d):null}return b},f:()=>8,c:!1}}});
k("mojo.internal.InterfaceRequest",function(a){return{$:{encode:function(b,c,d){if(!(b instanceof a))throw Error("Invalid request type. Expected "+a.name);if(!b.handle)throw Error("Unexpected null "+a.name);y(c,d,b.handle)},w:function(b,c){x(b,c,4294967295)},decode:function(b,c){return b=(b=C(b,c))?new a(b):null},f:()=>8,c:!1}}});
k("mojo.internal.AssociatedInterfaceProxy",function(a){return{$:{type:a,encode:function(){throw Error("Associated interfaces not supported yet.");},decode:function(){throw Error("Associated interfaces not supported yet.");},c:!1}}});k("mojo.internal.AssociatedInterfaceRequest",function(a){return{$:{type:a,encode:function(){throw Error("Associated interfaces not supported yet.");},decode:function(){throw Error("Associated interfaces not supported yet.");},c:!1}}});k("mojo.interfaceControl.RUN_MESSAGE_ID",4294967295);k("mojo.interfaceControl.RUN_OR_CLOSE_PIPE_MESSAGE_ID",4294967294);var Q={$:{}};k("mojo.interfaceControl.RunMessageParamsSpec",Q);var R={$:{}};k("mojo.interfaceControl.RunResponseMessageParamsSpec",R);var S={$:{}};k("mojo.interfaceControl.QueryVersionSpec",S);var T={$:{}};k("mojo.interfaceControl.QueryVersionResultSpec",T);var pa={$:{}};k("mojo.interfaceControl.FlushForTestingSpec",pa);var qa={$:{}};
k("mojo.interfaceControl.RunOrClosePipeMessageParamsSpec",qa);var ra={$:{}};k("mojo.interfaceControl.RequireVersionSpec",ra);var sa={$:{}};k("mojo.interfaceControl.EnableIdleTrackingSpec",sa);var ta={$:{}};k("mojo.interfaceControl.MessageAckSpec",ta);var ua={$:{}};k("mojo.interfaceControl.NotifyIdleSpec",ua);var va={$:{}};k("mojo.interfaceControl.RunInputSpec",va);var wa={$:{}};k("mojo.interfaceControl.RunOutputSpec",wa);var xa={$:{}};k("mojo.interfaceControl.RunOrClosePipeInputSpec",xa);
O(Q.$,"RunMessageParams",16,[N("input",0,0,va.$,null,!1)]);O(R.$,"RunResponseMessageParams",16,[N("output",0,0,wa.$,null,!0)]);O(S.$,"QueryVersion",0,[]);O(T.$,"QueryVersionResult",8,[N("version",0,0,K,0,!1)]);O(pa.$,"FlushForTesting",0,[]);O(qa.$,"RunOrClosePipeMessageParams",16,[N("input",0,0,xa.$,null,!1)]);O(ra.$,"RequireVersion",8,[N("version",0,0,K,0,!1)]);O(sa.$,"EnableIdleTracking",8,[N("timeoutInMicroseconds",0,0,ma,0,!1)]);O(ta.$,"MessageAck",0,[]);O(ua.$,"NotifyIdle",0,[]);
P(va.$,"RunInput",{queryVersion:{ordinal:0,type:S.$},flushForTesting:{ordinal:1,type:pa.$}});P(wa.$,"RunOutput",{queryVersionResult:{ordinal:0,type:T.$}});P(xa.$,"RunOrClosePipeInput",{requireVersion:{ordinal:0,type:ra.$},enableIdleTracking:{ordinal:1,type:sa.$},messageAck:{ordinal:2,type:ta.$},notifyIdle:{ordinal:3,type:ua.$}});var ya={$:oa()};k("mojo.native.SerializedHandleTypeSpec",ya);k("mojo.native.SerializedHandleType",{ca:0,da:1,ea:2,ba:3,aa:4,MIN_VALUE:0,MAX_VALUE:4});var za={$:{}};k("mojo.native.SerializedHandleSpec",za);var Aa={$:{}};k("mojo.native.NativeStructSpec",Aa);O(za.$,"SerializedHandle",8,[N("theHandle",0,0,L,null,!1),N("type",4,0,ya.$,0,!1)]);O(Aa.$,"NativeStruct",16,[N("data",0,0,M(J,!1),null,!1),N("handles",8,0,M(za.$,!1),null,!0)]);k("mojo.pipeControl.RUN_OR_CLOSE_PIPE_MESSAGE_ID",4294967294);var Ba={$:{}};k("mojo.pipeControl.RunOrClosePipeMessageParamsSpec",Ba);var Ca={$:{}};k("mojo.pipeControl.DisconnectReasonSpec",Ca);var Da={$:{}};k("mojo.pipeControl.PeerAssociatedEndpointClosedEventSpec",Da);var Ea={$:{}};k("mojo.pipeControl.PauseUntilFlushCompletesSpec",Ea);var Fa={$:{}};k("mojo.pipeControl.FlushAsyncSpec",Fa);var Ga={$:{}};k("mojo.pipeControl.RunOrClosePipeInputSpec",Ga);
O(Ba.$,"RunOrClosePipeMessageParams",16,[N("input",0,0,Ga.$,null,!1)]);O(Ca.$,"DisconnectReason",16,[N("customReason",0,0,K,0,!1),N("description",8,0,na,null,!1)]);O(Da.$,"PeerAssociatedEndpointClosedEvent",16,[N("id",0,0,K,0,!1),N("disconnectReason",8,0,Ca.$,null,!0)]);O(Ea.$,"PauseUntilFlushCompletes",8,[N("flushPipe",0,0,L,null,!1)]);O(Fa.$,"FlushAsync",8,[N("flusherPipe",0,0,L,null,!1)]);
P(Ga.$,"RunOrClosePipeInput",{peerAssociatedEndpointClosedEvent:{ordinal:0,type:Da.$},pauseUntilFlushCompletes:{ordinal:1,type:Ea.$},flushAsync:{ordinal:2,type:Fa.$}});function Ha(a,b){var c={flushForTesting:{}};return new Promise(d=>{I(a.a,4294967295,b,1,Q.$,{input:c});a.b.set(b,d)})}function Ia(a,b,c){return 4294967295===b.F?(c=new DataView(c,b.M),c=new F(c,[]),b.flags&1?(b=b.requestId,G(c,Q.$.$.B).input.hasOwnProperty("flushForTesting")?(I(a.a,4294967295,b,2,R.$,{output:null}),a=!0):a=!1):(a=a.b.get(b.requestId))?(a(),a=!0):a=!1,a):!1}
var Ja=class{constructor(a){this.a=a;this.b=new Map}},Ka=class{constructor(a,b,c,d,e){this.requestId=a;this.F=b;this.i=c;this.b=d;this.a=e}};function La(a){for(const b of a.a.values())b()}var U=class{constructor(){this.a=new Map;this.b=0}addListener(a){const b=++this.b;this.a.set(b,a);return b}removeListener(a){return this.a.delete(a)}};k("mojo.internal.interfaceSupport.ConnectionErrorEventRouter",U);U.prototype.removeListener=U.prototype.removeListener;U.prototype.addListener=U.prototype.addListener;
k("mojo.internal.interfaceSupport.PendingReceiver",class{get handle(){}});function Ma(a,b){Na(a.b);a.b=null;for(const c of a.a.keys())a.a.get(c).a(Error(b));a.a=new Map}
var V=class{constructor(a,b){this.handle=null;this.W=a;this.b=null;this.A=0;this.a=new Map;this.l=null;this.J=new U;b instanceof MojoHandle&&this.v(b)}G(){let {handle0:a,handle1:b}=Mojo.createMessagePipe();this.v(a);return new this.W(b)}v(a){if(this.handle)throw Error("Remote already bound.");this.handle=a;const b=new Pa(a);b.l=this.N.bind(this);b.i=this.i.bind(this);b.start();this.l=new Ja(a);this.b=b;this.A=0;this.a=new Map}T(){if(this.b){var a=this.b;a.a&&(a.a.cancel(),a.a=null)}}close(){Ma(this,
"Message pipe closed.")}L(){return this.J}Y(a,b,c,d){if(!this.handle)throw Error("Attempting to use an unbound remote. Try $.bindNewPipeAndPassReceiver() first.");if(c&&(!this.b||null===this.b.a))return Promise.reject(Error("The pipe has already been closed."));const e=this.A++,f={};b.$.B.m.forEach((g,h)=>f[g.name]=d[h]);I(this.handle,a,e,c?1:0,b,f);return c?new Promise((g,h)=>{this.a.set(e,new Ka(e,a,c,g,h))}):Promise.resolve()}I(){return Ha(this.l,this.A++)}N(a,b){var c=new DataView(a);c=la(c);
if(!Ia(this.l,c,a)){if(!(c.flags&2)||c.flags&1)return this.i("Received unexpected request message");var d=this.a.get(c.requestId);this.a.delete(c.requestId);if(!d)return this.i("Received unexpected response message");a=G(new F(new DataView(a,c.M),b),d.i.$.B);if(!a||c.F!==d.F)return this.i("Received malformed response message");d.b(a)}}i(a){Ma(this,a);La(this.J)}};k("mojo.internal.interfaceSupport.InterfaceRemoteBase",V);V.prototype.flushForTesting=V.prototype.I;V.prototype.sendMessage=V.prototype.Y;
V.prototype.getConnectionErrorEventRouter=V.prototype.L;V.prototype.close=V.prototype.close;V.prototype.unbind=V.prototype.T;V.prototype.bindHandle=V.prototype.v;var W=class{constructor(a){this.a=a}G(){return this.a.G()}close(){this.a.close()}I(){return this.a.I()}};k("mojo.internal.interfaceSupport.InterfaceRemoteBaseWrapper",W);W.prototype.flushForTesting=W.prototype.I;W.prototype.close=W.prototype.close;W.prototype.bindNewPipeAndPassReceiver=W.prototype.G;
var Qa=class{constructor(){this.a=new Map;this.b=0}removeListener(a){this.a.get(a)();return this.a.delete(a)}};k("mojo.internal.interfaceSupport.CallbackRouter",Qa);Qa.prototype.removeListener=Qa.prototype.removeListener;
var X=class{constructor(a){this.a=new Map;this.b=a}addListener(a){const b=++this.b.b;this.a.set(b,a);this.b.a.set(b,()=>this.a.delete(b));return b}V(a){return a?this.i.bind(this):this.l.bind(this)}l(a){const b=Array.from(arguments);this.a.forEach(c=>c.apply(null,b))}i(a){const b=Array.from(arguments),c=Array.from(this.a.values()).map(e=>e.apply(null,b));let d;for(const e of c)if(void 0!==e){if(void 0!==d)throw Error("Multiple listeners attempted to reply to a message");d=e}return d}};
k("mojo.internal.interfaceSupport.InterfaceCallbackReceiver",X);X.prototype.createReceiverHandler=X.prototype.V;X.prototype.addListener=X.prototype.addListener;
var Ra=class{constructor(a,b,c){this.b=a;this.a=b;this.i=c}},Y=class{constructor(a){this.a=new Map;this.N=a;this.i=new Map;this.A=null;this.l=new U}X(a,b,c,d){this.i.set(a,new Ra(b,c,d))}v(a){const b=new Pa(a);this.a.set(a,b);b.l=this.J.bind(this,a);b.i=this.b.bind(this,a);b.start();this.A=new Ja(a)}H(){let a=new this.N;this.v(a.$.G().handle);return a}R(){for(const a of this.a.values())Na(a);this.a.clear()}L(){return this.l}J(a,b,c){const d=new DataView(b),e=la(d);if(!Ia(this.A,e,b)){if(e.flags&2)throw Error("Received unexpected response on interface receiver");
var f=this.i.get(e.F);if(!f)throw Error("Received unknown message");var g=G(new F(new DataView(b,e.M),c),f.b.$.B);if(!g)throw Error("Received malformed message");b=f.i.apply(null,f.b.$.B.m.map(h=>g[h.name]));if(f.a){if(void 0===b)throw this.b(a),Error("Message expects a reply but its handler did not provide one.");b instanceof Promise||(b=Promise.resolve(b));b.then(h=>{I(a,e.F,e.requestId,2,f.a,h)}).catch(()=>{this.b(a)})}}}b(a){const b=this.a.get(a);b&&(La(this.l),Na(b),this.a.delete(a))}};
k("mojo.internal.interfaceSupport.InterfaceReceiverHelperInternal",Y);Y.prototype.getConnectionErrorEventRouter=Y.prototype.L;Y.prototype.closeBindings=Y.prototype.R;Y.prototype.bindNewPipeAndPassRemote=Y.prototype.H;Y.prototype.bindHandle=Y.prototype.v;Y.prototype.registerHandler=Y.prototype.X;var Z=class{constructor(a){this.a=a}v(a){this.a.v(a)}H(){return this.a.H()}close(){this.a.R()}};k("mojo.internal.interfaceSupport.InterfaceReceiverHelper",Z);Z.prototype.close=Z.prototype.close;
Z.prototype.bindNewPipeAndPassRemote=Z.prototype.H;Z.prototype.bindHandle=Z.prototype.v;function Na(a){a.a&&(a.a&&(a.a.cancel(),a.a=null),a.b.close())}
var Pa=class{constructor(a){this.b=a;this.l=null;this.i=()=>{};this.a=null}start(){this.a=this.b.watch({readable:!0},this.A.bind(this))}A(){for(;this.a;){const a=this.b.readMessage();if(a.result==Mojo.RESULT_SHOULD_WAIT)break;if(a.result==Mojo.RESULT_FAILED_PRECONDITION){this.i();break}if(a.result!=Mojo.RESULT_OK)throw Error("Unexpected error on HandleReader: "+a.result);this.l(a.buffer,a.handles)}}};}).call(this);
